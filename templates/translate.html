{% extends "base.html" %}
{% block content %}

<h1>Translate</h1>

<div class="card">
  <label for="textIn">Text</label>
  <textarea id="textIn" rows="5" style="width:100%;" placeholder="Type something to translate..."></textarea>

  <div style="margin-top: 12px; display:flex; gap:10px; align-items:center;">
    <label for="target">Target</label>
    <select id="target">
      <option value="es">Spanish</option>
      <option value="fr">French</option>
      <option value="de">German</option>
      <option value="it">Italian</option>
    </select>

    <button class="btn btn--primary" id="btnTranslate">Translate</button>
  </div>

  <p id="status" style="margin-top: 10px;"></p>

  <div id="result" style="white-space: pre-wrap; margin-top: 10px;"></div>
</div>

<script>
  const btn = document.getElementById("btnTranslate");
  const textEl = document.getElementById("textIn");
  const targetEl = document.getElementById("target");
  const statusEl = document.getElementById("status");
  const resultEl = document.getElementById("result");

  btn.addEventListener("click", async () => {
    const text = textEl.value.trim();
    const target = targetEl.value;

    if (!text) {
      statusEl.textContent = "Enter some text first.";
      resultEl.textContent = "";
      return;
    }

    statusEl.textContent = "Translatingâ€¦";
    resultEl.textContent = "";

    const res = await fetch("/api/translate", {
      method: "POST",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify({ text, target })
    });

    const data = await res.json().catch(() => ({}));

    if (!res.ok || !data.success) {
      statusEl.textContent = data.error || "Translation failed";
      return;
    }

    statusEl.textContent = "Done.";
    resultEl.textContent = data.translated;
  });
</script>

{% endblock %}
